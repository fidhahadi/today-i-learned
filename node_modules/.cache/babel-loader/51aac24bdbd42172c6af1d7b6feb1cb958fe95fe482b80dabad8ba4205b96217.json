{"ast":null,"code":"import _regeneratorRuntime from\"/home/fidha/Desktop/work/TodayILearned/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/home/fidha/Desktop/work/TodayILearned/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/home/fidha/Desktop/work/TodayILearned/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/fidha/Desktop/work/TodayILearned/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import'./style.css';import supabase from'./supabase';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CATEGORIES=[{name:\"technology\",color:\"#3b82f6\"},{name:\"science\",color:\"#16a34a\"},{name:\"finance\",color:\"#ef4444\"},{name:\"society\",color:\"#eab308\"},{name:\"entertainment\",color:\"#db2777\"},{name:\"health\",color:\"#14b8a6\"},{name:\"history\",color:\"#f97316\"},{name:\"news\",color:\"#8b5cf6\"}];function isValidHttpUrl(string){var url;try{url=new URL(string);}catch(_){return false;}return url.protocol===\"http:\"||url.protocol===\"https:\";}function NewFactForm(_ref){var setFacts=_ref.setFacts,setshowForm=_ref.setshowForm;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),source=_useState4[0],setSource=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),category=_useState6[0],setcategory=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isUploading=_useState8[0],setisUploading=_useState8[1];var textLength=text.length;function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _yield$supabase$from$,newFact,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0://1. Prevent browser reload\ne.preventDefault();console.log(text,source,category);//2. check if data is valid,if so create a new fact\nif(!(text&&isValidHttpUrl(source)&&category&&textLength<=200)){_context.next=16;break;}// const newFact = {\n//     id: Math.round(Math.random() * 10000000),\n//     text,\n//     source,\n//     category,\n//     votesInteresting: 0,\n//     votesMindblowing: 0,\n//     votesFalse: 0,\n//     createdIn: new Date().getFullYear(),\n// };\n//upload fact to supabase and receive the new fact object\nsetisUploading(true);_context.next=6;return supabase.from(\"facts\").insert([{text:text,source:source,category:category}]).select();case 6:_yield$supabase$from$=_context.sent;newFact=_yield$supabase$from$.data;error=_yield$supabase$from$.error;setisUploading(false);console.log(error);//4.add the new fact to the ui , add the fact state\\\n// adding the previous facts to the newly added fact\nsetFacts(function(facts){return[newFact[0]].concat(_toConsumableArray(facts));});setText(\"\");setSource(\"\");setcategory(\"\");setshowForm(false);case 16:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"form\",{className:\"formEl fact-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",disabled:isUploading,placeholder:\"Share a fact with the world...\",value:text,onChange:function onChange(e){return setText(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{children:200-textLength}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",disabled:isUploading,value:source,onChange:function onChange(e){return setSource(e.target.value);},placeholder:\"Trustworthy source...\"}),/*#__PURE__*/_jsxs(\"select\",{value:category,disabled:isUploading,onChange:function onChange(e){return setcategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose category:\"}),CATEGORIES.map(function(cat){return/*#__PURE__*/_jsx(\"option\",{value:cat.name,children:cat.name.toUpperCase()},cat.name);})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-large\",disabled:isUploading,children:\"Post\"})]});}export default NewFactForm;","map":{"version":3,"names":["React","useState","supabase","jsx","_jsx","jsxs","_jsxs","CATEGORIES","name","color","isValidHttpUrl","string","url","URL","_","protocol","NewFactForm","_ref","setFacts","setshowForm","_useState","_useState2","_slicedToArray","text","setText","_useState3","_useState4","source","setSource","_useState5","_useState6","category","setcategory","_useState7","_useState8","isUploading","setisUploading","textLength","length","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","_yield$supabase$from$","newFact","error","wrap","_callee$","_context","prev","next","preventDefault","console","log","from","insert","select","sent","data","facts","concat","_toConsumableArray","stop","className","onSubmit","children","type","disabled","placeholder","value","onChange","target","map","cat","toUpperCase"],"sources":["/home/fidha/Desktop/work/TodayILearned/src/NewFactForm.jsx"],"sourcesContent":["import React, { useState } from 'react'\nimport './style.css';\nimport supabase from './supabase';\n\n\n\nconst CATEGORIES = [\n    { name: \"technology\", color: \"#3b82f6\" },\n    { name: \"science\", color: \"#16a34a\" },\n    { name: \"finance\", color: \"#ef4444\" },\n    { name: \"society\", color: \"#eab308\" },\n    { name: \"entertainment\", color: \"#db2777\" },\n    { name: \"health\", color: \"#14b8a6\" },\n    { name: \"history\", color: \"#f97316\" },\n    { name: \"news\", color: \"#8b5cf6\" },\n];\n\nfunction isValidHttpUrl(string) {\n    let url;\n\n    try {\n        url = new URL(string);\n    } catch (_) {\n        return false;\n    }\n\n    return url.protocol === \"http:\" || url.protocol === \"https:\";\n}\n\nfunction NewFactForm({ setFacts, setshowForm }) {\n    const [text, setText] = useState(\"\");\n    const [source, setSource] = useState(\"\");\n    const [category, setcategory] = useState(\"\");\n    const [isUploading, setisUploading] = useState(false);\n    const textLength = text.length;\n\n    async function handleSubmit(e) {\n        //1. Prevent browser reload\n        e.preventDefault();\n\n        console.log(text, source, category);\n\n        //2. check if data is valid,if so create a new fact\n        if (text && isValidHttpUrl(source) && category && textLength <= 200) {\n            // const newFact = {\n            //     id: Math.round(Math.random() * 10000000),\n            //     text,\n            //     source,\n            //     category,\n            //     votesInteresting: 0,\n            //     votesMindblowing: 0,\n            //     votesFalse: 0,\n            //     createdIn: new Date().getFullYear(),\n            // };\n            //upload fact to supabase and receive the new fact object\n            setisUploading(true);\n            const { data: newFact, error } = await supabase.from(\"facts\").insert([{ text, source, category }]).select();\n            setisUploading(false);\n            console.log(error);\n\n            //4.add the new fact to the ui , add the fact state\\\n            // adding the previous facts to the newly added fact\n            setFacts((facts) => [newFact[0], ...facts]);\n            setText(\"\");\n            setSource(\"\");\n            setcategory(\"\");\n            setshowForm(false);\n        }\n\n        //.3. create new fact object\n\n        //5. reset input fields\n        // 6. close the form\n\n    }\n\n    return (\n\n        <form className=\"formEl fact-form\" onSubmit={handleSubmit}>\n            <input type=\"text\" disabled={isUploading} placeholder=\"Share a fact with the world...\" value={text}\n                onChange={(e) => setText(e.target.value)} />\n            <span>{200 - textLength}</span>\n            <input type=\"text\" disabled={isUploading} value={source} onChange={(e) => setSource(e.target.value)} placeholder=\"Trustworthy source...\" />\n            <select value={category} disabled={isUploading} onChange={(e) => setcategory(e.target.value)}>\n                <option value=\"\">Choose category:</option>\n                {CATEGORIES.map((cat) => <option key={cat.name} value={cat.name}>{cat.name.toUpperCase()}</option>)}\n            </select>\n            <button className=\"btn btn-large\" disabled={isUploading} >Post</button>\n        </form>\n\n    )\n}\n\nexport default NewFactForm"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}